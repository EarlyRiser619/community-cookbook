<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org/"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head th:replace="fragments :: head"></head>
<body>
<nav th:replace="fragments :: navigation"></nav>
<br />
<h1 th:text="${title}">Default Title</h1>



<form method="post" th:object="${recipe}">
    <div>
        <label th:for="name">Name of Recipe</label>
        <input th:field="*{name}" required />
        <span th:errors="*{name}" class="error"></span>
    </div>
    <div>
        <label th:for="type">Type</label>
        <select th:field="*{type}" required>
            <option value="" hidden>Select a Type</option>
            <option th:each="recipeType : ${recipeTypes}"
                    th:text="${recipeType.name}"
                    th:value="${recipeType}"></option>
        </select>
    </div>
    <!--<div>
        <label th:for="categories">Would you like to add a category for your recipe?</label>
        <input th:field="*{categories}" type="text" id="catVal" />
        <button onClick="addLi(); return false;">Add Category</button>
        <span th:errors="*{categories}" class="errors"></span>
    </div> -->
    <div>
        <label th:for="category">Category</label>
        <select th:field="*{categories}" required>
            <option value="" hidden>Select a Category</option>
            <option th:each="category : ${categories}"
                    th:text="${category.name}"
                    th:value="${category}"></option>
        </select>
    </div>

    <!-- <div th:each="category : ${categories}" name="categoryId" />
        <input type="checkbox" th:field="*{categories}" />
        <label th:text="${category.name}">Category</label>
    </div>-->
    <div>
        <label th:for="source">Source</label>
        <input th:field="*{source}" />
        <span th:errors="*{source}" class="errors"></span>
    </div>
    <div>
        <label th:for="servings">Number of Servings</label>
        <input th:field="*{servings}" />
        <span th:errors="*{servings}" class="errors"></span>
    </div>
    <div>
        <label th:for="time">Prep Time (in minutes)</label>
        <input th:field="*{time}" />
        <span th:errors="*{time}" class="errors"></span>
    </div>
    <table>
        <thead>
            <tr>
                <!--<th th:text="#{recipe.ingredients.id}">Item</th>-->
                <th> <!--th:text="#{recipe.ingredients.measurement}"-->Measurement   </th>
                <th> <!--th:text="#{recipe.ingredients.name}"-->  Ingredient</th>
                <th>
                    <button type="submit" name="addIngredient" th:value="#{recipe.ingredient.add}"> <!--th:text="#{recipe.ingredient.add}"-->Add Ingredient</button>
                </th>
            </tr>
        </thead>
        <tbody>
        <tr th:each="ingredient,ingredientStat : *{ingredients}">
            <!--<td th:text="${ingredientStat.count}"></td>-->
            <td>
                <input type="text" th:field="*{ingredients[__${ingredientStat.index}__].measurement}" />
            </td>
            <td>
                <input type="text" th:field="*{ingredients[__${ingredientStat.index}__].name}" />
            </td>
            <td>
                <button type="submit" name="removeIngredient"
                        th:value="${ingredientStat.index}" th:text="#{recipe.ingredient.remove}">Remove Ingredient</button>
            </td>
        </tr>
        </tbody>
    </table>
    <!--<div>
        <label th:for="ingredients">Ingredients</label>
        <input th:field="*{ingredients}" type="text" id="txtVal" />
        <button onclick="addLi(); return false;">Add Ingredient</button>
        <span th:errors="*{ingredients}" class="errors"></span>

        <ul id="ingrList">
        </ul>

        <script>
            function addLi()
            {
                txtDoc = document.getElementById('txtVal');
                var txtVal = txtDoc.value;
                    listNode = document.getElementById('ingrList');
                    liNode = document.createElement("LI");
                    txtNode = document.createTextNode(txtVal);
                liNode.appendChild(txtNode);
                listNode.appendChild(liNode);
                txtDoc.value = '';
                txtDoc.focus();
             }
        </script>
    </div>-->
    <table>
        <thead>
            <tr>
                <th>Instructions</th>
                <th>
                    <button type="submit" name="addStep" th:value="#{recipe.instructions.add}">Add Step</button>
                </th>
            </tr>
        </thead>
        <tbody>
        <tr th:each="step,stepStat : *{instructions}">
            <td>
                <input type="text" th:field="*{instructions[__${stepStat.index}__]}" />
            </td>
            <td>
                <button type="submit" name="removeStep"
                        th:value="${stepStat.index}" th:text="#{recipe.instructions.remove}">Remove Ingredient</button>
            </td>
        </tbody>
    </table>

    <!--<div>
        <label th:for="instructions">Instructions</label>
        <input type="text" th:field="*{instructions}"  required />
        <span th:errors="*{instructions}" class="errors"></span>
    </div>-->


    <input type="hidden" value="*{user}" name="userId" />
    <input type="submit" value="Add Recipe" />


</form>

</body>
</html>